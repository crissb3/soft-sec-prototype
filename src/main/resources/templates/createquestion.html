<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>SecQuiz</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" th:src="@{/js/popup.js}"></script>
    <link rel="stylesheet" th:href="@{/chosen/chosen.css}">
    <script>
        function copyForm(){
            const question = document.getElementById("questionForm").value;
            const fake1 = document.getElementById("f1Form").value;
            const fake2 = document.getElementById("f2Form").value;
            const fake3 = document.getElementById("f3Form").value;
            const correct = document.getElementById("correctForm").value;
            const explanation = document.getElementById("explForm").value;

            document.getElementById("question").value = question;
            document.getElementById("fake1").value = fake1;
            document.getElementById("fake2").value = fake2;
            document.getElementById("fake3").value = fake3;
            document.getElementById("correct").value = correct;
            document.getElementById("explanation").value = explanation;
        }
    </script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        function success(){
            let response = "[[${response}]]";
            let id = "[[${id}]]"
            let msg = "[[${message1}]]"
            if(response === 'success'){
                Swal.fire({
                    title: 'Success!',
                    text: "Question created successfully! ID: " +id,
                    icon: 'success',
                    confirmButtonColor: '#008CBA'
                });
            }
            else if(response === 'warn')
            {
                Swal.fire({
                    title: 'Warning!',
                    text: 'Question was not created. '+msg,
                    icon: 'warning',
                    confirmButtonColor: '#008CBA'
                });
            }
            else if(response === 'error')
            {
                Swal.fire({
                    title: 'Error!',
                    text: 'Question was not created. '+msg,
                    icon: 'error',
                    confirmButtonColor: '#008CBA',
                });
            }

        }
    </script>

</head>
<body onload="success()">
    <div class="text_frame_menu">
        <div class="single_text_in_menu" onclick="window.location.href='/'">Home</div>
        <div class="single_text_in_menu" onclick="window.location.href='/adminindex'">Admin</div>
        <div class="single_text_in_menu" onclick="window.location.href='/Quiz/Leaderboard/Select'">Leaderboard</div>
    </div>
    <div class="logo_text">SoftSec Quiz</div>

<div class="center">
    <div class="container">
        <div class="center">
        </div>
        <div style="margin-left: 30%; width: 700px; max-width: 700px; white-space: nowrap; overflow: hidden">
            <strong style="font-weight: normal; color: white; font-size: 18px;" th:text="${message}"></strong>
        </div>
        <form th:action="@{/addQA}" style="font-size: 24px; margin-left: 50px; margin-top: 50px; float: left;" th:method="post" enctype="multipart/form-data">
            <strong style="color: white; font-weight: normal; text-shadow: 2px 2px black">Image as question:</strong>
            <input type="file" name="file" accept="image/png, image/jpeg" style="font-family: poetsenone, sans-serif; color: white">

            <textarea id="questionForm" th:text="${addquestion}" class="textarea_custom" type="text" name="addquestion" style="height: 50px;" placeholder="Enter question"
                      onfocus="this.placeholder=''" onblur="this.placeholder='Enter question'"></textarea>

            <strong style="color: white; font-weight: normal; text-shadow: 2px 2px black">Add 3 fake answers and the correct answer:</strong>

            <textarea id="f1Form" th:text="${fakeanswer1}" class="textarea_custom" placeholder="Enter first fake answer"
                      onfocus="this.placeholder=''" onblur="this.placeholder='Enter first fake answer'" type="text" name="fakeanswer1"></textarea>

            <textarea id="f2Form" th:text="${fakeanswer2}" class="textarea_custom" placeholder="Enter second fake answer"
                      onfocus="this.placeholder=''" onblur="this.placeholder='Enter second fake answer'" type="text" name="fakeanswer2"></textarea>

            <textarea id="f3Form" th:text="${fakeanswer3}" class="textarea_custom" placeholder="Enter third fake answer"
                      onfocus="this.placeholder=''" onblur="this.placeholder='Enter third fake answer'" type="text" name="fakeanswer3"></textarea>

            <textarea id="correctForm" th:text="${correctanswer}" class="textarea_custom" placeholder="Enter the correct answer"
                      onfocus="this.placeholder=''" onblur="this.placeholder='Enter the correct answer'" type="text" name="correctanswer"></textarea>

            <strong style="color: white; font-weight: normal; text-shadow: 2px 2px black">Add Tags to question:</strong>
            <div style="height: 75px; margin-top: 12px;">
            <select name="tags" data-placeholder="Select tags" multiple class="chosen-select" style="width: 120px; overflow-y: scroll; height: 10px;">
                <div th:each="tag : ${tags}">
                    <option name="tags_list" th:value="${tag.TId}" th:text="${tag.tag}"></option>
                </div>
            </select>
            <script th:src="@{/chosen/chosen.jquery.js}" type="text/javascript"></script>

            <script>
                $(".chosen-select").chosen();
                $("ul.chosen-choices").css({ "overflow": 'auto', "max-height": "70px", "float": "left"});
            </script>
            </div>
            <textarea id="explForm" th:text="${explanation}" class="textarea_custom" placeholder="Add an explanation to the answer"
                      onfocus="this.placeholder=''" onblur="this.placeholder='Add an explanation to the answer'" type="text" name="explanation" style="float: left"></textarea><br><br>
            <input class="button_5050" type="submit" name="addquestionsubmit" value="Add question" style="float: left; top: 71%; left: 30%; font-size: 20px; position: absolute">

        </form>
        <form th:method="post" style="float: left; position: absolute; top: 62%; left: 12%" th:action="@{/addTag}">
            <label class="custom-field one" style="top: -2px">
                <input type="text" name="custom_tag" placeholder=" "><span class="placeholder">Enter Custom Tag</span>
                <input type="hidden" name="correctanswer" id="correct">
                <input type="hidden" name="question" id="question">
                <input type="hidden" name="f1" id="fake1">
                <input type="hidden" name="f2" id="fake2">
                <input type="hidden" name="f3" id="fake3">
                <input type="hidden" name="explanation" id="explanation">
            </label>
            <button type="submit" class="button_plus" onclick="copyForm()">+</button>
        </form>
        <form style="margin-top: 50px; margin-left: 51%;">
            <a style="width: 35%" class="button_5050" th:href="@{'https://capec.mitre.org/data/definitions/1000.html'}" target="popup"
               onclick="window.open('https://capec.mitre.org/data/definitions/1000.html','name','width=600,height=500')">Capec - Mechanisms Of Attack</a>
            <br>
            <a style="width: 35%" class="button_5050" th:href="@{'https://wiki.sei.cmu.edu/confluence/display/java'}" target="popup"
               onclick="window.open('https://wiki.sei.cmu.edu/confluence/display/java','name','width=600,height=500')">SEI CERT - Coding Standard for Java</a>
            <br>
            <a style="width: 35%" class="button_5050" th:href="@{'https://cwe.mitre.org/data/definitions/699.html'}" target="popup"
               onclick="window.open('https://cwe.mitre.org/data/definitions/699.html','name','width=600,height=500')">CWE - Software Development</a>
        </form>
        <div class="popup" id="popup-1" style="float:right;">
            <div class="overlay" th:onClick="togglePopup()"></div>
            <div class="content">
                <div class="close-btn" th:onClick="togglePopup()">&times;</div>
                <h1 style="">Select image as question:</h1>
                <strong style="color: black; font-weight: normal; font-size: 22px">
                    You can select image as question by clicking the select file feature <br> and picking the desired picture from your files.
                </strong>
                <h1>How to:</h1>
                <strong style="font-size: 22px">
                    To create a question you have to fill in all the fields. <br>
                    Type your question, three fake answers and a correct answer. <br>
                    You can select tags if you want to categorize your question.<br>
                    You can also create your own tag by typing in your desired tag,<br>
                    then hitting "+" to add it to the list of tags.<br>
                    When you have filled in all the fields and selected the tags <br>
                    that fit the question you can click 'Add question' and it will <br>
                    be saved to the questions list.<br> The questions list is available when you create a quiz.
                </strong>
                <h1>Links:</h1>
                <strong style="font-size: 22px">
                    There are three links that you can find above, these can help you <br>
                    construct questions about software and hardware weaknesses/threats <br> and how to fight them,
                    and also Java Coding Standards.
                </strong>
            </div>
        </div>
        <button style="margin-top: 150px; margin-left: 305px; font-size: 35px; border-radius: 50%; height: 250px" class="button_5050" th:onClick="togglePopup()">Need help?<br> Click me!</button>



    </div>
</div>
</body>

</html>